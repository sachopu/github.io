<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8", name="viewport" content="width=device-Width, initial-scale=1"/>
    
    <!--スタイルでbodyタグの余白をmargin:0でつぶす、オーバースクロールを無効にする-->
    <style>
        body{
            margin: 0;
            overflow: hidden;
        }
    </style>
    
    <!--threeの読み込み-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/105/three.min.js"></script>
</head>
    <body>
        <canvas id="myCanvas"></canvas>
        <script>
            //読み込み待機
            window.addEventListener('load', init);
            function init() {

                ////////////////////////////////////////////////////////
                
                //サイズを指定　　
                var width = window.innerWidth;
                var height = window.innerHeight;
                
                /*
                const width = 960;
                const height = 540;
                */
                                   
                //シーン作成
                const scene = new THREE.Scene();

                //カメラ作成
                                
                camera = new THREE.PerspectiveCamera( 75, width / height, 1, 1100 );
				camera.target = new THREE.Vector3( 0, 0, 0 );

                 //レンダラー定義　
                const renderer = new THREE.WebGLRenderer({
                canvas: document.querySelector('#myCanvas')
                });
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setSize(width, height);
                
                ////////////////////////////////////////////////////////
               
                //サイズ変更検出   　1
                window.addEventListener('resize', onResize);
                //リサイズ処理    　2
                function onResize(){ 
                    
                    //サイズを取得　
                    width = window.innerWidth;
                    height = window.innerHeight;
                    
                    //カメラのアスペクト比
                    camera.aspect = width / height;
                    camera.updateProjectionMatrix();
                    
                    //レンダラーのサイズを調整
                    renderer.setPixelRatio(window.devicePixelRatio);
                    renderer.setSize(width, height);
                }
                
                ////////////////////////////////////////////////////////////////
                
                //3Dモデル作成

                var geometry = new THREE.BoxGeometry(10,10,10);
                //マテリアル
                const material = new THREE.MeshNormalMaterial();
               
            
                skybox();
                function skybox (){
                    const cubeTexLoader = new THREE.CubeTextureLoader();

                    const texture1 = "skybox-01.png";
                    const texture2 = "skybox-02.png";
                    const texture3 = "skybox-03.png";
                    const texture4 = "skybox-04.png";
                    const texture5 = "skybox-05.png";
                    const texture6 = "skybox-06.png";

                    const urls = [ texture1, 
                                texture2,
                                texture3, 
                                texture4,
                                texture5, 
                                texture6 ];

                    cubeTexLoader.load( urls, function(tex) {
                        const cubeShader = THREE.ShaderLib[ 'cube' ];
                        cubeShader.uniforms[ 'tCube' ].value = tex;

                        const skyBoxMaterial = new THREE.ShaderMaterial({
                            fragmentShader: cubeShader.fragmentShader,
                            vertexShader: cubeShader.vertexShader,
                            uniforms: cubeShader.uniforms,
                            depthWrite: false,
                            side: THREE.BackSide
                        });
                        const mesh = new THREE.Mesh( new THREE.BoxGeometry( 3000, 3000, 3000, 1, 1, 1 ), 
                                                  skyBoxMaterial);
                        scene.add( mesh );
                   }
                );
                }

                
                
                
                /* const box = new THREE.Mesh(geometry, material);
                scene.add(box);
                
                env('lok-yiu-cheung-o6k0ZH1eOwg-unsplash.jpg');
                var envmesh; 
                
                function env(textururl){

                    let geometry = new THREE.SphereBufferGeometry( 500, 60, 40 );
				    // invert the geometry on the x-axis so that all of the faces point inward
				    geometry.scale( - 1, 1, 1 );

                    let texture = new THREE.TextureLoader().load( textururl );
				    let material = new THREE.MeshBasicMaterial( { map: texture } );

				    envmesh = new THREE.Mesh( geometry, material );
                    
                    scene.add( envmesh );
                }*/

                ////////////////////////////////////////////////////////////////
               
                //毎フレーム実行関数　A
                tick();

                //毎フレーム実行されるループイベント　Aとする
                function tick() {
                    box.rotation.y += 0.01; //とりあえず動き 
                   // envmesh.rotation.y += 0.01;
                    renderer.render(scene, camera); //シーンとカメラレンダリング
                    mesh.rotation.y +=0.01;
                    mesh.rotation.x +=0.01;
                    
                    //requestAnimationFrame()は引数として渡された関数を、毎フレーム実行します。
                    requestAnimationFrame(tick);
                }
                
                ////////////////////////////////////////////////////////////////
            }
        </script>

    </body>
</html>
