<!DOCTYPE html>
<script src='./arjs3/aframe-master.min.js'></script>
<script src='./arjs3/aframe-extras.min.js'></script>
<script src="https://unpkg.com/aframe-sprite-particles-component@0.5.4/aframe-sprite-particles-component.js"></script>

<!--<script>
AFRAME.registerComponent('registerevents', {
    init: function () {
        var marker = this.el;

        // マーカーを検出したイベントの登録
        marker.addEventListener('markerFound', function () {
            var markerId = marker.id;
            console.log('markerFound', markerId);
            this.vid = document.querySelector("#honou");
            // アニメーションの開始
            honou.sprite-particles__fire.enable.emit('true');
        });

        // マーカーを見失ったイベントの登録
        marker.addEventListener('markerLost', function () {
            var markerId = marker.id;
            console.log('markerLost', markerId);

            // アニメーションの停止
            document.querySelector('#honou').emit('false');
        });
    }
});
</script>

<script>
    window.onload = function() {
        AFRAME.registerComponent('videohandler', {
            init: function () {
                var marker = this.el;

                this.vid = document.querySelector("#vid");

                marker.addEventListener('markerFound', function () {
                    this.vid.play();
                }.bind(this));
    
		marker.addEventListener('markerLost', function() {
			this.vid.pause();
			this.vid.currentTime = 0;
		}.bind(this));
            }
        });
    };
</script>-->

<style>
  .arjs-loader {
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .arjs-loader div {
    text-align: center;
    font-size: 1.25em;
    color: white;
  }
</style>

<!-- rawgithack development URL -->
<script src='./arjs3/aframe-ar-nft.js'></script>

<body style='margin : 0px; overflow: hidden;'>
   <!-- minimal loader shown until image descriptors are loaded -->
  <div class="arjs-loader">
    <div>Loading, please wait...</div>
  </div>
    <a-scene
        id="sc"
        vr-mode-ui='enabled: false;'
        renderer="logarithmicDepthBuffer: true;"
        renderer="gammaOutput: true;"
        
        embedded arjs='trackingMethod: best; sourceType: webcam; debugUIEnabled: false;'
        >
        

        <!-- use rawgithack to retrieve the correct url for nft marker (see 'pinball' below) -->
        <a-nft
            type='nft' url='./arjs3/dataNFT/ususamanft'
            smooth='true' smoothCount='10' smoothTolerance='0.01' smoothThreshold='5'>
            <a-entity
            gltf-model='./arjs3/ususama.glb'
            scale="160 160 160"
            position="80 160 -80"
            rotation="-20 -20 "
            animation-mixer
            >
           </a-entity>          
           <a-entity position="0 1 0"
                scale="80 160 160"
                sprite-particles__sparks="position: -1 -1 -1..1 1 1; depthTest:false; color: yellow, red; spawnRate: 150; lifeTime: 0.3..2; velocity: 0 1..0 2; angularVelocity: -50 0 -50..50 0 50; scale: 10..20,5..30"></a-entity>
           </a-entity>
           <a-entity id="honou" 
            position="0 80 -20"
            scale="160 160 160"
            sprite-particles__smoke="delay:5; position: -1 -1 -1..1 2 1;texture: assets/fog.png; velocity: -.1 1 -.3.. .3 1 .3; spawnRate: 12; lifeTime: 2; scale: 800,1600; opacity: 0,0.2,0; color: #666,#222; rotation: -120..120"
            sprite-particles__fire="delay:3; depthTest:true; depthWrite:false; position: -0.5 -1 -0.5..0.5 1 0.5 ; texture: assets/explosion_sheet.png; textureFrame: 5 5; velocity: 0.2 0.1 -0.2..-0.6 -0.1 0.2; acceleration: 0 1 0..0 3 0; spawnRate: 10; scale: 1000,1800..1800,2400; lifeTime: 1..2; opacity: 1,0; angularVelocity: 0 0 0; blending: additive"
            sprite-particles__sparks="position: 0 0 0..5 0 0; color: yellow, red; spawnRate: 10; lifeTime: 0.3..0.7; velocity: 0 2.5..0 4.5; angularVelocity: -50 0 -50..50 0 50; scale: .2...20"></a-entity>
           </a-entity>

        </a-nft>
        <a-light type="ambient" intensity="4" color="#ffffff"></a-light>
        <a-light type="point" intensity="0" position="200 100 100"></a-light>
		<a-entity camera></a-entity>
    </a-scene>
</body>
</html>